---
title:  "Redis 缓存穿透、缓存击穿、缓存雪崩"
tags: Redis
---

Redis 缓存穿透、缓存击穿、缓存雪崩、热点数据失效
<!--more-->
#### Redis 缓存穿透

> 查询一条数据库中不存在的数据，缓存和数据库都查询不到这条数据，但是每次请求都会打到数据库上面。

解决：

1. 进行参数过滤，过滤掉此种无意义key
2. 在Redis中存入此key的值为null,后面查询这个key的时候，直接返回null

#### Redis 缓存击穿

> 在高并发的系统中，大量请求同事查询一个key时，此时这个正好失效了，就会导致大量请求都打到数据库上面去。

解决：

1. 上面的现象是多个线程同时去查询数据库的这条数据，我们可以在第一个查询数据的请求上使用一个互斥锁来解决，其他线程走到这一步时拿不到锁就等待，等第一个线程查询到了数据，做好缓存。后面的线程进来发现已有缓存，就直接走缓存。

#### Redis 缓存雪崩

> 当某一时刻发生大规模的缓存失效，可能是缓存服务宕机，或者当量缓存同一时间失效等，会有大量的请求进来直接打到DB上面。

解决：

1. 使用集群缓存，保证缓存服务高可用，如果是使用Redis ，可以使用 主从 + 哨兵，Redis Cluster 来避免 Redis 全盘崩溃的情况
2. 多套缓存机制 + 服务限流与降级处理
3. 开启Redis持久化支持，尽快恢复缓存集群
4. 针对缓存 Key ，设置缓存过期时间时，让他们的失效时间错开，比如在一个基础时间上 加上或减去一个范围内的随机值

参考：
> <https://juejin.im/post/5c9a67ac6fb9a070cb24bf34>
